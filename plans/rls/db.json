[
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "organizations",
    "policyname": "org_delete_owner_or_super",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "((get_user_role_in_org(id) = 'owner'::text) OR ((auth.jwt() ->> 'user_role'::text) = 'super_admin'::text))",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "organizations",
    "policyname": "org_insert_owner_or_super",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "((get_user_role_in_org(id) = 'owner'::text) OR ((auth.jwt() ->> 'user_role'::text) = 'super_admin'::text))"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "organizations",
    "policyname": "org_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "((((auth.jwt() ->> 'organization_id'::text))::uuid = id) OR (EXISTS ( SELECT 1\n   FROM users u\n  WHERE ((u.id = auth.uid()) AND (u.organization_id = organizations.id)))))",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "organizations",
    "policyname": "org_update_owner_or_super",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "((get_user_role_in_org(id) = 'owner'::text) OR ((auth.jwt() ->> 'user_role'::text) = 'super_admin'::text))",
    "with_check": "((get_user_role_in_org(id) = 'owner'::text) OR ((auth.jwt() ->> 'user_role'::text) = 'super_admin'::text))"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "users",
    "policyname": "users_delete_own",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "((id = ( SELECT auth.uid() AS uid)) AND (organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid))",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "users",
    "policyname": "users_insert_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "((organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid) AND (id = ( SELECT auth.uid() AS uid)))"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "users",
    "policyname": "users_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "((organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid) OR (id = ( SELECT auth.uid() AS uid)))",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "users",
    "policyname": "users_update_own",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "((id = ( SELECT auth.uid() AS uid)) AND (organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid))",
    "with_check": "((id = ( SELECT auth.uid() AS uid)) AND (organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid))"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "suppliers",
    "policyname": "suppliers_delete_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "suppliers",
    "policyname": "suppliers_insert_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "suppliers",
    "policyname": "suppliers_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "suppliers",
    "policyname": "suppliers_update_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "models",
    "policyname": "models_delete_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "models",
    "policyname": "models_insert_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "models",
    "policyname": "models_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "models",
    "policyname": "models_update_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement",
    "policyname": "procurement_insert_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement",
    "policyname": "procurement_no_delete",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "false",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement",
    "policyname": "procurement_no_update",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "false",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement",
    "policyname": "procurement_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement_images",
    "policyname": "delete_by_service_only",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "cmd": "DELETE",
    "qual": "false",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement_images",
    "policyname": "insert own images",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement_images",
    "policyname": "select own images",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "cmd": "SELECT",
    "qual": "((organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid) AND (archived = false))",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement_images",
    "policyname": "update_by_service_only",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "cmd": "UPDATE",
    "qual": "false",
    "with_check": "false"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "procurement_images",
    "policyname": "update_last_accessed",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": "((organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid) AND (last_accessed_at IS NOT NULL) AND (NOT (storage_path IS DISTINCT FROM storage_path)))"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "audit_logs",
    "policyname": "audit_logs_select_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "SELECT",
    "qual": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "audit_logs",
    "policyname": "audit_logs_insert_same_org",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "INSERT",
    "qual": null,
    "with_check": "(organization_id = ((auth.jwt() ->> 'organization_id'::text))::uuid)"
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "audit_logs",
    "policyname": "audit_logs_no_update",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "UPDATE",
    "qual": "false",
    "with_check": null
  },
  {
    "type": "RLS",
    "schemaname": "public",
    "tablename": "audit_logs",
    "policyname": "audit_logs_no_delete",
    "permissive": "PERMISSIVE",
    "roles": "{authenticated}",
    "cmd": "DELETE",
    "qual": "false",
    "with_check": null
  }
]